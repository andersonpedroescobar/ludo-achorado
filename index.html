<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Achorado: Chaos Edition</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

   <!-- PANTALLA DE INICIO -->
    <div id="start-screen" class="modal-overlay">
        <div class="modal-content">
            <h1>üé≤ LUDO ACHORADO üé≤</h1>
            <p>Selecciona la cantidad de jugadores:</p>
            <div class="player-buttons">
                <button onclick="iniciarJuego(2)">2 Jugadores</button>
                <button onclick="iniciarJuego(3)">3 Jugadores</button>
                <button onclick="iniciarJuego(4)">4 Jugadores</button>
            </div>
        </div>
    </div>

    <!-- MODAL CHIKAWA (6) -->
    <div id="chikawa-modal" class="chikawa-overlay" style="display: none;">
        <div class="chikawa-content">
            <img src="img/chikawa1.png" alt="¬°Sali√≥ 6!" class="chikawa-anim">
            <h2>¬°HA SALIDO UN 6!</h2>
            <p>¬°Repites turno o sacas ficha!</p>
        </div>
    </div>

    <!-- MODAL PODER (REGALO) -->
    <div id="power-modal" class="chikawa-overlay" style="display: none;">
        <div class="chikawa-content">
            <img src="img/chikawaregalo.png" alt="Regalo" class="chikawa-anim" style="width: 150px;">
            <h2 id="power-title" style="color: #2ecc71;">¬°PODER OBTENIDO!</h2>
            <p id="power-desc" style="font-size: 1.2rem;">...</p>
        </div>
    </div>

    <div class="main-container">
        
        <div class="board-area">
            <div class="board-wrapper">
                <img src="img/ludo.jpg" alt="Tablero Ludo" class="board-img">
                
                <!-- CAPA DE REGALOS -->
                <div id="gifts-container" class="grid-system"></div>

                <!-- CAPA DE FICHAS -->
                <div id="tokens-container" class="grid-system"></div>

                <!-- EFECTOS VISUALES (FUEGO/HIELO) -->
                <div id="fx-container" class="grid-system" style="pointer-events: none;"></div>
            </div>
        </div>

        <div class="controls-area">
            
            <div class="controls-header">
                <div style="text-align: left;">
                    <div style="font-size: 0.8rem; color: #aaa;">Turno Global</div>
                    <div id="global-turn-count" style="font-size: 1.5rem; font-weight: bold;">0</div>
                </div>
                <h2 id="turn-indicator" style="font-size: 1.2rem;">...</h2>
                <div style="display:flex; gap:5px;">
                    <button class="btn-reset" onclick="reiniciarPartida()">‚Üª</button>
                    <!-- Bot√≥n Info Poderes -->
                    <button class="btn-info power-info" onclick="togglePowerRules()">‚ö°</button>
                    <!-- Bot√≥n Info Reglas -->
                    <button class="btn-info" onclick="toggleRules()">üìú</button>
                </div>
            </div>

            <!-- MODAL REGLAS SLOT -->
            <div id="rules-modal" class="rules-modal" style="display: none;">
                <h3>üìú Reglas del Slot</h3>
                <ul>
                    <li>dos <b>1</b> = +1 paso</li>
                    <li>dos <b>2</b> = +2 pasos</li>
                    <li>tres <b>1</b> = +2 pasos</li>
                    <li>tres <b>2</b> = +4 pasos</li>
                    <li>tres <b>7</b> = +7 pasos</li>
                    <li>Dado <b>6</b> = ¬°Repite turno!</li>
                </ul>
                <button onclick="toggleRules()" class="btn-close-rules">Cerrar</button>
            </div>

            <!-- MODAL INFO PODERES -->
            <div id="power-rules-modal" class="rules-modal" style="display: none; top: 100px;">
                <h3 style="color: #2ecc71;">‚ö° Poderes (Regalos)</h3>
                <ul>
                    <li>üéÅ Aparecen 3 cada 10 turnos.</li>
                    <li>üî• <b>Fuego:</b> Quema una zona del tablero (mata a todos ah√≠).</li>
                    <li>‚ùÑÔ∏è <b>Congelar:</b> Un enemigo pierde 2 turnos.</li>
                    <li>üé≤ <b>Extra:</b> Tiras de nuevo al instante.</li>
                </ul>
                <button onclick="togglePowerRules()" class="btn-close-rules">Cerrar</button>
            </div>
            
            <div class="slot-machine-container" id="main-btn" onclick="accionPrincipal()">
                <img src="img/chikawa_slots.png" alt="Slot" class="slot-img">
                <div class="slot-display">
                    <span id="reel1">-</span>
                    <span id="reel2">-</span>
                    <span id="reel3">-</span>
                </div>
                <div id="btn-text" style="color:gold; font-weight:bold; margin-top:5px;">GIRAR SLOT</div>
            </div>

            <div id="math-result" class="math-display">
                Slot + Dado = Total
            </div>
            
            <p id="game-msg">¬°Haz clic para empezar!</p>
            
            <div class="dice-area">
                <img src="img/dado1.jpg" id="dice-img" alt="Dado">
            </div>

            <div class="identity-box">
                <p style="margin:5px 0; font-size:0.8rem; color:#aaa;">¬øQui√©n eres t√∫?</p>
                <div class="identity-buttons">
                    <button class="btn-id red" onclick="elegirIdentidad(0)">üî¥</button>
                    <button class="btn-id green" onclick="elegirIdentidad(1)">üü¢</button>
                    <button class="btn-id yellow" onclick="elegirIdentidad(2)">üü°</button>
                    <button class="btn-id blue" onclick="elegirIdentidad(3)">üîµ</button>
                </div>
                <div id="my-identity-display" style="font-size:0.8rem; margin-top:5px; color:#fff;">Espectador</div>
            </div>
        </div>
    </div>

    <!-- SCRIPT FIREBASE -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import { getDatabase, ref, set, onValue, update } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

      // ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è ¬°PEGA AQU√ç TU CONFIGURACI√ìN DE FIREBASE! ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
      const firebaseConfig = {
         apiKey: "AIzaSyCGWY4IeNxX9ry33Ll6O8Jo3eayYTqh5xA",
         authDomain: "ludoachoradodb.firebaseapp.com",
         databaseURL: "https://ludoachoradodb-default-rtdb.firebaseio.com",
         projectId: "ludoachoradodb",
         storageBucket: "ludoachoradodb.firebasestorage.app",
         messagingSenderId: "938756448190",
         appId: "1:938756448190:web:e7b7fb6eb10640febb23ef",
         measurementId: "G-HHPG96CEX4"
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      window.db = db; window.ref = ref; window.set = set; window.onValue = onValue; window.update = update;
    </script>

    <script type="module" src="js/script.js"></script>
</body>
</html>